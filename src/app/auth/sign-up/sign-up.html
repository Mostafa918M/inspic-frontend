<form class="grid gap-5" [formGroup]="signupForm" (ngSubmit)="onSubmit()" novalidate>
  <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
    <div class="flex flex-col gap-1.5">
      <label class="text-sm font-medium text-neutral-700 dark:text-neutral-300" for="firstName">First Name</label>
      <input id="firstName" type="text" formControlName="firstName" placeholder="First name"
             class="h-11 rounded-xl px-3.5 bg-white dark:bg-neutral-900/60 border border-neutral-300 dark:border-neutral-700
                    placeholder:text-neutral-400 text-[15px] outline-none
                    focus:border-neutral-500 dark:focus:border-neutral-500 focus:ring-4 focus:ring-neutral-900/5 dark:focus:ring-white/5"/>
      @if (signupForm.get('firstName')?.touched && signupForm.get('firstName')?.invalid) {
        <ul class="mt-1.5 text-[13px] text-rose-600 space-y-0.5">
          @if (signupForm.get('firstName')?.hasError('required')) { <li>First name is required.</li> }
          @if (signupForm.get('firstName')?.hasError('minlength')) { <li>At least 2 characters.</li> }
        </ul>
      }
    </div>

    <div class="flex flex-col gap-1.5">
      <label class="text-sm font-medium text-neutral-700 dark:text-neutral-300" for="lastName">Last Name</label>
      <input id="lastName" type="text" formControlName="lastName" placeholder="Last name"
             class="h-11 rounded-xl px-3.5 bg-white dark:bg-neutral-900/60 border border-neutral-300 dark:border-neutral-700
                    placeholder:text-neutral-400 text-[15px] outline-none
                    focus:border-neutral-500 dark:focus:border-neutral-500 focus:ring-4 focus:ring-neutral-900/5 dark:focus:ring-white/5"/>
      @if (signupForm.get('lastName')?.touched && signupForm.get('lastName')?.invalid) {
        <ul class="mt-1.5 text-[13px] text-rose-600 space-y-0.5">
          @if (signupForm.get('lastName')?.hasError('required')) { <li>Last name is required.</li> }
          @if (signupForm.get('lastName')?.hasError('minlength')) { <li>At least 2 characters.</li> }
        </ul>
      }
    </div>

    <div class="flex flex-col gap-1.5">
      <label class="text-sm font-medium text-neutral-700 dark:text-neutral-300" for="username">Username</label>
      <input id="username" type="text" formControlName="username" autocomplete="username" placeholder="Username"
             class="h-11 rounded-xl px-3.5 bg-white dark:bg-neutral-900/60 border border-neutral-300 dark:border-neutral-700
                    placeholder:text-neutral-400 text-[15px] outline-none
                    focus:border-neutral-500 dark:focus:border-neutral-500 focus:ring-4 focus:ring-neutral-900/5 dark:focus:ring-white/5"/>
      @if (signupForm.get('username')?.touched && signupForm.get('username')?.invalid) {
        <ul class="mt-1.5 text-[13px] text-rose-600 space-y-0.5">
          @if (signupForm.get('username')?.hasError('required')) { <li>Username is required.</li> }
          @if (signupForm.get('username')?.hasError('minlength')) { <li>At least 3 characters.</li> }
        </ul>
      }
    </div>

    <div class="flex flex-col gap-1.5">
      <label class="text-sm font-medium text-neutral-700 dark:text-neutral-300" for="email">Email</label>
      <input id="email" type="email" formControlName="email" autocomplete="email" placeholder="E-mail"
             class="h-11 rounded-xl px-3.5 bg-white dark:bg-neutral-900/60 border border-neutral-300 dark:border-neutral-700
                    placeholder:text-neutral-400 text-[15px] outline-none
                    focus:border-neutral-500 dark:focus:border-neutral-500 focus:ring-4 focus:ring-neutral-900/5 dark:focus:ring-white/5"/>
      @if (signupForm.get('email')?.touched && signupForm.get('email')?.invalid) {
        <ul class="mt-1.5 text-[13px] text-rose-600 space-y-0.5">
          @if (signupForm.get('email')?.hasError('required')) { <li>Email is required.</li> }
          @if (signupForm.get('email')?.hasError('email')) { <li>Enter a valid email address.</li> }
        </ul>
      }
    </div>

    <div class="flex flex-col gap-1.5">
      <label class="text-sm font-medium text-neutral-700 dark:text-neutral-300" for="password">Password</label>
      <input id="password" type="password" formControlName="password" autocomplete="new-password" placeholder="Password"
             class="h-11 rounded-xl px-3.5 bg-white dark:bg-neutral-900/60 border border-neutral-300 dark:border-neutral-700
                    placeholder:text-neutral-400 text-[15px] outline-none
                    focus:border-neutral-500 dark:focus:border-neutral-500 focus:ring-4 focus:ring-neutral-900/5 dark:focus:ring-white/5"/>
      @if (signupForm.get('password')?.touched && signupForm.get('password')?.errors) {
        @if (signupForm.get('password')?.hasError('passwordInvalid')) {
          @let errs = (signupForm.get('password')?.getError('passwordInvalid') ?? []);
          <ul class="mt-1.5 text-[13px] text-rose-600 space-y-0.5">
            @for (err of errs; track $index) { <li>{{ err }}</li> }
          </ul>
        }
        @if (signupForm.get('password')?.hasError('required')) {
          <ul class="mt-1.5 text-[13px] text-rose-600 space-y-0.5"><li>Password is required.</li></ul>
        }
      }
    </div>

    <div class="flex flex-col gap-1.5">
      <label class="text-sm font-medium text-neutral-700 dark:text-neutral-300" for="confirmPassword">Repeat Password</label>
      <input id="confirmPassword" type="password" formControlName="confirmPassword" autocomplete="new-password" placeholder="Repeat Password"
             class="h-11 rounded-xl px-3.5 bg-white dark:bg-neutral-900/60 border border-neutral-300 dark:border-neutral-700
                    placeholder:text-neutral-400 text-[15px] outline-none
                    focus:border-neutral-500 dark:focus:border-neutral-500 focus:ring-4 focus:ring-neutral-900/5 dark:focus:ring-white/5"/>
      @if (signupForm.get('confirmPassword')?.touched && signupForm.get('confirmPassword')?.hasError('required')) {
        <ul class="mt-1.5 text-[13px] text-rose-600 space-y-0.5"><li>Please confirm your password.</li></ul>
      }
      @if (signupForm.touched && signupForm.errors?.['passwordMismatch']) {
        <ul class="mt-1.5 text-[13px] text-rose-600 space-y-0.5"><li>Passwords do not match.</li></ul>
      }
    </div>
  </div>

  <button type="submit" [disabled]="signupForm.invalid"
          class="h-12 w-full rounded-xl font-semibold bg-neutral-900 text-white dark:bg-white dark:text-neutral-900
                 transition hover:opacity-90 disabled:opacity-50 disabled:cursor-not-allowed">
    {{ loading ? 'Creating Accountâ€¦' : 'Create Account' }}
  </button>

  @if(errorMsg) { <p class="text-sm text-rose-600">{{ errorMsg }}</p> }

  <div class="relative my-5 text-center text-sm text-neutral-500">
    <span class="relative z-[1] bg-white dark:bg-neutral-950 px-3">Or register with</span>
    <span class="absolute left-0 top-1/2 h-px w-full -translate-y-1/2 bg-neutral-200 dark:bg-neutral-800"></span>
  </div>

  <div class="grid grid-cols-1 sm:grid-cols-2 gap-3">
    <button type="button" (click)="googleSignIn()"
            class="h-11 w-full rounded-xl border border-neutral-300 dark:border-neutral-700
                   bg-white dark:bg-neutral-900/60 hover:bg-neutral-50 dark:hover:bg-neutral-900
                   flex items-center justify-center gap-2 font-medium cursor-pointer  ">
      <span class="inline-flex items-center gap-2">
        <svg width="18" height="18" viewBox="0 0 18 18" aria-hidden="true"> <path d="M17.64 9.2045c0-.6387-.0573-1.2518-.164-1.8364H9v3.473h4.843c-.209 1.1278-.8436 2.0813-1.796 2.7214v2.258h2.904c1.699-1.5655 2.689-3.8682 2.689-6.616z" fill="#4285F4"/> <path d="M9 18c2.43 0 4.469-0.806 5.958-2.175l-2.904-2.258c-.806.54-1.837.861-3.054.861-2.348 0-4.336-1.585-5.046-3.716H.958v2.335C2.44 15.983 5.486 18 9 18z" fill="#34A853"/> <path d="M3.954 10.712A5.41 5.41 0 0 1 3.67 9c0-.595.103-1.171.284-1.712V4.953H.958A9.002 9.002 0 0 0 0 9c0 1.46.35 2.84.958 4.047l2.996-2.335z" fill="#FBBC05"/> <path d="M9 3.542c1.32 0 2.507.454 3.44 1.343l2.58-2.58C13.463.879 11.424 0 9 0 5.486 0 2.44 2.017.958 4.953l2.996 2.335C4.664 5.156 6.652 3.542 9 3.542z" fill="#EA4335"/> </svg>
        Google
      </span>
    </button>
  </div>
</form>
